#
#	Ограничение небезопасных конструкций
#	https://perldoc.perl.org/strict
use strict;
#
#	Управление необязательными предупреждениями
#	https://perldoc.perl.org/warnings
use warnings;
#
#	Декодирование символов
#	https://perldoc.perl.org/Encode
use Encode qw(decode encode);
#
#	Создание, изменение и проверка PDF-файлов
#	https://metacpan.org/pod/PDF::API2
use PDF::API2;
#
#	Служебный класс для построения макетов таблиц
#	https://metacpan.org/pod/PDF::Table
use PDF::Table;
#
#	Создаем PDF
#
my $pdf = PDF::API2->new();
#
#	Устанавливаем шрифт с кириллицей
#
my	$font = $pdf->ttfont('Arial.ttf');
#
#	Добавить пустую страницу
#
my	$page = $pdf->page();

# Данные таблицы
my @headers = ("Имя", "Возраст", "Город", "Профессия");
my @data = (
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
    ["Sam-Иван", "25", "Москва", "Инженер"],
    ["Мария", "30", "Санкт-Петербург", "Врач"],
    ["Алексей", "28", "Новосибирск", "Программист"],
    ["Ольга", "35", "Екатеринбург", "Учитель"],
);
#
#	Декодирование данных
#
foreach my $i (0 .. $#data)
{
	foreach my $j (0 .. $#{ $data[$i] })
	{
		$data[$i]->[$j] = decode('UTF-8', $data[$i]->[$j]);
	}
}
#
#	Создаем таблицу
#
my	$table = PDF::Table->new();
#
#	Опции таблицы
#	https://metacpan.org/pod/PDF::Table#Table-settings
	$table->table(
        $pdf,
        $page,
		\@data,
#		headers 	=> \@headers,
#		header => 1,
header_props => {
    'font_size'	=> 18,
    'fg_color' 	=> '#004444',
    'bg_color' 	=> 'yellow',
    'repeat'   	=> 1,
    'justify'  	=> 'center',
},
		font 		=> $font,
		font_size	=> 14,
        x         	=> 50,
        w         	=> 500,
        start_y   	=> 750,
        start_h   	=> 300,
        padding   	=> 5,
		size		=> '* 1cm 2* 4cm',
#        background_color_odd  => "gray",
#        background_color_even => "lightblue",
);
#
#	Сохраняем PDF
#
$pdf->saveas('russian_table2.pdf');

print STDERR encode('windows-1251',decode('UTF-8',"PDF файл создан: russian_table2.pdf\n"));

exit;

__DATA__
# 1. Initialize PDF object and page
my $pdf = PDF::API2->new(-file => "output_table.pdf");
my $page = $pdf->page;

# 2. Prepare table data
my $table_data = [
    ["Header 1", "Header 2 Привет, Hello: Starting Y-coordinate on the first page. Maximum height on the first page// X-coordinate for table start", "Header 3"],
    ["Data A1", "Data B1", "Data C1"],
    ["Data A2", "Data B2", "Data C2"],
    # ... more rows
];

# 3. Create PDF::Table object
my $pdftable = PDF::Table->new;

# 4. Build the table
$pdftable->table(
    $pdf,
    $page,
    $table_data,
    x           => 50,    # X-coordinate for table start
    w           => 500,   # Width of the table
    start_y     => 750,   # Starting Y-coordinate on the first page
    next_y      => 700,   # Starting Y-coordinate on subsequent pages
    start_h     => 300,   # Maximum height on the first page
    next_h      => 500,   # Maximum height on subsequent pages
    padding     => 5,     # Cell padding
    background_color_odd  => "gray",
    background_color_even => "lightblue",
    # Add font settings if needed: -font => $pdf->add_font('Verdana'),
);

# 5. Save the PDF
$pdf->saveas();